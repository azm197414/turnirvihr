<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–¢—É—Ä–Ω–∏—Ä–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞ "–í–∏—Ö—Ä—å" - –û–ù–õ–ê–ô–ù –ü–†–û–°–ú–û–¢–†</title>
    <style>
        * {
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Arial', sans-serif;
            margin: 0;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }
        
        .container {
            max-width: 100%;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
            overflow: hidden;
        }
        
        .header {
            background: linear-gradient(135deg, #2c3e50, #34495e);
            color: white;
            padding: 25px;
            text-align: center;
        }
        
        .header h1 {
            margin: 0;
            font-size: 24px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 15px;
        }
        
        .status-bar {
            background: #f8f9fa;
            padding: 15px 25px;
            border-bottom: 2px solid #e9ecef;
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            align-items: center;
        }
        
        .status-item {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 8px 15px;
            background: white;
            border-radius: 20px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        
        .online-indicator {
            width: 10px;
            height: 10px;
            background: #2ecc71;
            border-radius: 50%;
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0% { opacity: 1; }
            50% { opacity: 0.5; }
            100% { opacity: 1; }
        }
        
        .refresh-btn {
            background: #3498db;
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 20px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 5px;
            font-weight: bold;
            transition: all 0.3s;
        }
        
        .refresh-btn:hover {
            background: #2980b9;
            transform: translateY(-2px);
        }
        
        .refresh-btn:active {
            transform: translateY(0);
        }
        
        .refresh-btn.loading {
            background: #7f8c8d;
        }
        
        .table-container {
            overflow-x: auto;
            padding: 20px;
        }
        
        /* 1. –û–±—â–∞—è —Ä–∞–º–∫–∞ –≤—Å–µ–π —Ç–∞–±–ª–∏—Ü—ã - –¢–µ–º–Ω–æ —Å–∏–Ω—è—è */
        table {
            width: 100%;
            border-collapse: collapse;
            min-width: 1400px;
            font-size: 14px;
            border: 3px solid #1a5276; /* –¢–µ–º–Ω–æ-—Å–∏–Ω—è—è —Ä–∞–º–∫–∞ */
            box-shadow: 0 0 0 1px #1a5276; /* –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è —Ä–∞–º–∫–∞ */
        }
        
        th {
            background: #2c3e50;
            color: white;
            padding: 12px 8px;
            font-weight: bold;
            text-align: center;
            position: sticky;
            top: 0;
            z-index: 10;
        }
        
        td {
            padding: 10px 8px;
            border: 1px solid #e0e0e0;
            text-align: center;
        }
        
        /* 2-6. –†–∞–∑–¥–µ–ª–∏—Ç–µ–ª–∏ –º–µ–∂–¥—É –æ—Å–Ω–æ–≤–Ω—ã–º–∏ —Å–µ–∫—Ü–∏—è–º–∏ */
        .divider-team-participant {
            border-right: 2px solid white !important;
        }
        
        .divider-participant-lithoff {
            border-right: 2px solid white !important;
        }
        
        .divider-lithoff-quadrosim {
            border-right: 2px solid white !important;
        }
        
        .divider-quadrosim-track {
            border-right: 2px solid white !important;
        }
        
        .divider-track-results {
            border-right: 2px solid white !important;
        }
        
        /* 7. –†–∞–∑–¥–µ–ª–∏—Ç–µ–ª–∏ –≤–Ω—É—Ç—Ä–∏ —Å–µ–∫—Ü–∏–∏ –õ–∏—Ç–æ—Ñ—Ñ */
        .divider-lithoff-angle-time {
            border-right: 1px solid white !important;
        }
        
        .divider-lithoff-time-score {
            border-right: 1px solid white !important;
        }
        
        /* 8. –†–∞–∑–¥–µ–ª–∏—Ç–µ–ª—å –≤–Ω—É—Ç—Ä–∏ —Å–µ–∫—Ü–∏–∏ –ö–≤–∞–¥—Ä–æ—Å–∏–º */
        .divider-quadrosim-time-score {
            border-right: 1px solid white !important;
        }
        
        /* 9. –†–∞–∑–¥–µ–ª–∏—Ç–µ–ª–∏ –≤–Ω—É—Ç—Ä–∏ —Å–µ–∫—Ü–∏–∏ –¢—Ä–∞—Å—Å—ã */
        .divider-track-laps-penalties {
            border-right: 1px solid white !important;
        }
        
        .divider-track-penalties-total {
            border-right: 1px solid white !important;
        }
        
        .divider-track-total-score {
            border-right: 1px solid white !important;
        }
        
        /* 10. –†–∞–∑–¥–µ–ª–∏—Ç–µ–ª—å –≤–Ω—É—Ç—Ä–∏ —Å–µ–∫—Ü–∏–∏ –†–µ–∑—É–ª—å—Ç–∞—Ç—ã */
        .divider-results-personal-team {
            border-right: 1px solid white !important;
        }
        
        /* 11. –†–∞–∑–¥–µ–ª–∏—Ç–µ–ª—å –º–µ–∂–¥—É –Ω–∞–∑–≤–∞–Ω–∏—è–º–∏ —Ä–∞–∑–¥–µ–ª–æ–≤ –∏ –∏—Ö —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º–∏ */
        .divider-section-results {
            border-bottom: 2px solid white !important;
        }
        
        /* –°—Ç–∏–ª–∏ –¥–ª—è —è—á–µ–µ–∫ */
        .team-cell {
            background: #ecf0f1;
            font-weight: bold;
            font-size: 16px;
        }
        
        .name-cell {
            text-align: left;
            font-weight: bold;
            background: #f8f9fa;
        }
        
        .result-cell {
            background: #e3f2fd;
            font-weight: bold;
            color: #1565c0;
        }
        
        .team-score-cell {
            background: #fff3e0;
            font-weight: bold;
            font-size: 16px;
            color: #e65100;
        }
        
        .penalty-header {
            background: #ffebee;
            color: #721c24;
        }
        
        .max-min-row td {
            background: #f5f5f5;
            font-weight: bold;
            color: #555;
            font-size: 12px;
        }
        
        .input-cell {
            background: white;
        }
        
        .section-header {
            background: #2c3e50;
            color: white;
        }
        
        .footer {
            background: #f8f9fa;
            padding: 20px;
            border-top: 2px solid #e9ecef;
            font-size: 14px;
            color: #6c757d;
        }
        
        .footer strong {
            color: #2c3e50;
        }
        
        .loading {
            display: none;
            text-align: center;
            padding: 40px;
            color: #7f8c8d;
        }
        
        .loading.active {
            display: block;
        }
        
        .loader {
            border: 4px solid #f3f3f3;
            border-top: 4px solid #3498db;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 0 auto 15px;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 15px 20px;
            background: #2ecc71;
            color: white;
            border-radius: 8px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
            display: none;
            z-index: 1000;
            animation: slideIn 0.3s;
        }
        
        @keyframes slideIn {
            from {
                transform: translateX(100%);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }
        
        .notification.error {
            background: #e74c3c;
        }
        
        .notification.info {
            background: #3498db;
        }
        
        @media (max-width: 768px) {
            body {
                padding: 10px;
            }
            
            .header h1 {
                font-size: 18px;
            }
            
            .status-bar {
                padding: 10px;
            }
            
            .table-container {
                padding: 10px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>
                <span>üèÜ</span>
                –¢—É—Ä–Ω–∏—Ä–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞ –∫–ª—É–±–∞ "–í–∏—Ö—Ä—å"
                <span>üèÜ</span>
            </h1>
            <p style="margin-top: 10px; opacity: 0.9;">–û–Ω–ª–∞–π–Ω-–ø—Ä–æ—Å–º–æ—Ç—Ä –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏</p>
        </div>
        
        <div class="status-bar">
            <div class="status-item">
                <span class="online-indicator"></span>
                <span>–û–ù–õ–ê–ô–ù</span>
            </div>
            
            <div class="status-item">
                <span>üïê</span>
                <span>–û–±–Ω–æ–≤–ª–µ–Ω–æ: <strong id="updateTime">–∑–∞–≥—Ä—É–∑–∫–∞...</strong></span>
            </div>
            
            <div class="status-item">
                <span>üëÅÔ∏è</span>
                <span>–†–µ–∂–∏–º –ø—Ä–æ—Å–º–æ—Ç—Ä–∞</span>
            </div>
            
            <button class="refresh-btn" id="refreshBtn">
                <span>üîÑ</span>
                <span>–û–±–Ω–æ–≤–∏—Ç—å</span>
            </button>
        </div>
        
        <div class="loading" id="loading">
            <div class="loader"></div>
            <p>–ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö —Ç—É—Ä–Ω–∏—Ä–∞...</p>
        </div>
        
        <div class="table-container" id="tableContainer">
            <table id="tournamentTable">
                <!-- –¢–∞–±–ª–∏—Ü–∞ –±—É–¥–µ—Ç —Å–æ–∑–¥–∞–Ω–∞ JavaScript -->
            </table>
        </div>
        
        <div class="footer">
            <p><strong>üìä –û–Ω–ª–∞–π–Ω-–ø—Ä–æ—Å–º–æ—Ç—Ä —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ —Ç—É—Ä–Ω–∏—Ä–∞</strong></p>
            <p>‚Ä¢ –î–∞–Ω–Ω—ã–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è —Å —Å–µ—Ä–≤–µ—Ä–∞ –∫–∞–∂–¥—ã–µ 30 —Å–µ–∫—É–Ω–¥</p>
            <p>‚Ä¢ –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç–∞–±–ª–∏—Ü—ã –¥–æ—Å—Ç—É–ø–Ω–æ —Ç–æ–ª—å–∫–æ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ç–æ—Ä—É</p>
            <p>‚Ä¢ –î–ª—è –≤–æ–ø—Ä–æ—Å–æ–≤ –∏ —É—Ç–æ—á–Ω–µ–Ω–∏–π –æ–±—Ä–∞—Ç–∏—Ç–µ—Å—å –∫ —Å—É–¥—å–µ —Ç—É—Ä–Ω–∏—Ä–∞</p>
            <p id="dataInfo">–ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö...</p>
            
            <p style="margin-top: 15px;"><strong>–§–æ—Ä–º—É–ª—ã —Ä–∞—Å—á–µ—Ç–æ–≤:</strong></p>
            <ul style="margin: 5px 0; padding-left: 20px;">
                <li><strong>–ë–∞–ª–ª—ã –õ–∏—Ç–æ—Ñ—Ñ:</strong> = (–£–≥–æ–ª/–ú–ê–ö–°_–£–≥–æ–ª √ó 70) + (–ú–ò–ù_–í—Ä–µ–º—è_–õ–ó/–í—Ä–µ–º—è_–õ–ó √ó 30)</li>
                <li><strong>–ë–∞–ª–ª—ã –ö–≤–∞–¥—Ä–æ—Å–∏–º:</strong> = (–ú–ò–ù_–í—Ä–µ–º—è_–ö–ó √ó 100) / –í—Ä–µ–º—è_–ö–ó</li>
                <li><strong>–ë–∞–ª–ª—ã –¢—Ä–∞—Å—Å—ã:</strong> = (–ö—Ä—É–≥–∏/–ú–ê–ö–°_–ö—Ä—É–≥–∏ √ó 100) ‚àí –°—É–º–º–∞_—à—Ç—Ä–∞—Ñ–æ–≤</li>
                <li><strong>–ò—Ç–æ–≥–æ–≤—ã–π –±–∞–ª–ª:</strong> = –ë–∞–ª–ª—ã –õ–ó + –ë–∞–ª–ª—ã –ö–ó + –ë–∞–ª–ª—ã –¢—Ä–∞—Å—Å—ã</li>
            </ul>
        </div>
    </div>
    
    <div class="notification" id="notification"></div>

    <script>
        // ========== –ù–ê–°–¢–†–û–ô–ö–ò ==========
        const DATA_URL = 'https://raw.githubusercontent.com/azm197414/turnirvihr/main/turnir_data.json';
        const UPDATE_INTERVAL = 30000; // 30 —Å–µ–∫—É–Ω–¥
        
        // ========== –î–ê–ù–ù–´–ï –£–ß–ê–°–¢–ù–ò–ö–û–í ==========
        const participants = [
            { team: "–ò–Ω—Ç–µ–Ω—Å–∏–≤", name: "–ö—Å–µ–Ω–∏—è –õ.", id: 1, teamIndex: 0 },
            { team: "–ò–Ω—Ç–µ–Ω—Å–∏–≤", name: "–°–≤—è—Ç–æ—Å–ª–∞–≤ –ï.", id: 2, teamIndex: 0 },
            { team: "–ü—Ä–æ—Ä—ã–≤", name: "–ù–∏–∫–∏—Ç–∞ –£.", id: 3, teamIndex: 1 },
            { team: "–ü—Ä–æ—Ä—ã–≤", name: "–í–∞—Ä—è –ê.", id: 4, teamIndex: 1 },
            { team: "–ê–ª—å—Ñ–∞", name: "–î–º–∏—Ç—Ä–∏–π –í.", id: 5, teamIndex: 2 },
            { team: "–ê–ª—å—Ñ–∞", name: "–ò–≤–∞–Ω –§.", id: 6, teamIndex: 2 },
            { team: "–°—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å", name: "–°–∞–≤–µ–ª–∏–π –°.", id: 7, teamIndex: 3 },
            { team: "–°—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å", name: "–ë–æ–≥–¥–∞–Ω –ï.", id: 8, teamIndex: 3 },
            { team: "–ú–æ—Ç–∏–≤–∞—Ü–∏—è", name: "–ê—Ä—Ç–µ–º –ü.", id: 9, teamIndex: 4 },
            { team: "–ú–æ—Ç–∏–≤–∞—Ü–∏—è", name: "–î–∞–Ω–∏–ª–∞ –õ.", id: 10, teamIndex: 4 }
        ];
        
        // ========== –í–°–ü–û–ú–û–ì–ê–¢–ï–õ–¨–ù–´–ï –§–£–ù–ö–¶–ò–ò ==========
        function showNotification(message, type = 'info', duration = 3000) {
            const notification = document.getElementById('notification');
            notification.textContent = message;
            notification.className = `notification ${type}`;
            notification.style.display = 'block';
            
            setTimeout(() => {
                notification.style.display = 'none';
            }, duration);
        }
        
        function showLoading(show) {
            document.getElementById('loading').classList.toggle('active', show);
            document.getElementById('tableContainer').style.display = show ? 'none' : 'block';
        }
        
        function timeToSeconds(timeStr) {
            if (!timeStr || timeStr === '00:00:00') return 0;
            const parts = timeStr.split(':');
            if (parts.length !== 3) return 0;
            const minutes = parseInt(parts[0]) || 0;
            const seconds = parseInt(parts[1]) || 0;
            const milliseconds = parseInt(parts[2]) || 0;
            return minutes * 60 + seconds + (milliseconds / 100);
        }
        
        function secondsToTime(seconds) {
            if (seconds <= 0) return '00:00:00';
            const mins = Math.floor(seconds / 60);
            const secs = Math.floor(seconds % 60);
            const ms = Math.round((seconds - Math.floor(seconds)) * 100);
            return `${mins.toString().padStart(2, '0')}:${secs.toString().padStart(2, '0')}:${ms.toString().padStart(2, '0')}`;
        }
        
        // ========== –°–û–ó–î–ê–ù–ò–ï –¢–ê–ë–õ–ò–¶–´ –°–û –í–°–ï–ú–ò –†–ê–ó–î–ï–õ–ò–¢–ï–õ–Ø–ú–ò ==========
        function createTable() {
            const table = document.getElementById('tournamentTable');
            table.innerHTML = '';
            
            // –ü–µ—Ä–≤–∞—è —Å—Ç—Ä–æ–∫–∞ –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤ (–æ—Å–Ω–æ–≤–Ω—ã–µ —Å–µ–∫—Ü–∏–∏) - –ë–ï–õ–´–ô —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª—å —Å–Ω–∏–∑—É
            const headerRow1 = table.insertRow();
            headerRow1.innerHTML = `
                <th rowspan="3" class="section-header divider-team-participant divider-section-results">–ö–æ–º–∞–Ω–¥–∞</th>
                <th rowspan="3" class="section-header divider-participant-lithoff divider-section-results">–£—á–∞—Å—Ç–Ω–∏–∫</th>
                <th colspan="3" class="section-header divider-lithoff-quadrosim divider-section-results">–õ–∏—Ç–æ—Ñ—Ñ</th>
                <th colspan="2" class="section-header divider-quadrosim-track divider-section-results">–ö–≤–∞–¥—Ä–æ—Å–∏–º</th>
                <th colspan="6" class="section-header divider-track-results divider-section-results">–†–µ–∞–ª—å–Ω–∞—è —Ç—Ä–∞—Å—Å–∞</th>
                <th colspan="2" class="section-header divider-section-results">–†–µ–∑—É–ª—å—Ç–∞—Ç—ã</th>
            `;
            
            // –í—Ç–æ—Ä–∞—è —Å—Ç—Ä–æ–∫–∞ –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤ (–ø–æ–¥—Å–µ–∫—Ü–∏–∏) - –ë–ï–õ–´–ô —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª—å —Å–Ω–∏–∑—É
            const headerRow2 = table.insertRow();
            headerRow2.innerHTML = `
                <th class="divider-lithoff-angle-time divider-section-results">–£–≥–æ–ª</th>
                <th class="divider-lithoff-time-score divider-section-results">–í—Ä–µ–º—è<br>(–ú–ú:–°–°:–ú–°)</th>
                <th class="divider-section-results">–ë–∞–ª–ª—ã</th>
                <th class="divider-quadrosim-time-score divider-section-results">–í—Ä–µ–º—è<br>(–ú–ú:–°–°:–ú–°)</th>
                <th class="divider-section-results">–ë–∞–ª–ª—ã</th>
                <th class="divider-track-laps-penalties divider-section-results">–ö–æ–ª-–≤–æ<br>–∫—Ä—É–≥–æ–≤</th>
                <th colspan="3" class="penalty-header divider-section-results">–®—Ç—Ä–∞—Ñ—ã<br>(–∫–æ–ª-–≤–æ –Ω–∞—Ä—É—à–µ–Ω–∏–π)</th>
                <th class="divider-track-penalties-total divider-section-results">–°—É–º–º–∞<br>—à—Ç—Ä–∞—Ñ–æ–≤</th>
                <th class="divider-track-total-score divider-section-results">–ë–∞–ª–ª—ã<br>—Ç—Ä–∞—Å—Å—ã</th>
                <th class="divider-results-personal-team divider-section-results">–ò—Ç–æ–≥–æ–≤—ã–π<br>–±–∞–ª–ª</th>
                <th class="divider-section-results">–ö–æ–º–∞–Ω–¥–Ω—ã–π<br>–±–∞–ª–ª</th>
            `;
            
            // –¢—Ä–µ—Ç—å—è —Å—Ç—Ä–æ–∫–∞ (–º–∞–∫—Å–∏–º—É–º—ã/–º–∏–Ω–∏–º—É–º—ã)
            const headerRow3 = table.insertRow();
            headerRow3.className = 'max-min-row';
            headerRow3.innerHTML = `
                <td class="divider-lithoff-angle-time">–ú–∞–∫—Å<br><span id="maxAngle">0</span></td>
                <td class="divider-lithoff-time-score">–ú–∏–Ω<br><span id="minTimeLz">00:00:00</span></td>
                <td>–ú–∞–∫—Å<br><span id="maxScoreLz">0.00</span></td>
                <td class="divider-quadrosim-time-score">–ú–∏–Ω<br><span id="minTimeKz">00:00:00</span></td>
                <td>–ú–∞–∫—Å<br><span id="maxScoreKz">0.00</span></td>
                <td class="divider-track-laps-penalties">–ú–∞–∫—Å<br><span id="maxLaps">0</span></td>
                <td class="penalty-header">–í–æ—Ä–æ—Ç–∞<br>(-5)</td>
                <td class="penalty-header">–ü–∞–¥–µ–Ω–∏–µ<br>(-10)</td>
                <td class="penalty-header">–ü–µ—Ä–µ–≤–æ—Ä–æ—Ç<br>(-20)</td>
                <td class="divider-track-penalties-total">–ú–∏–Ω<br><span id="minPenalty">0</span></td>
                <td class="divider-track-total-score">–ú–∞–∫—Å<br><span id="maxScoreTrack">0.00</span></td>
                <td class="divider-results-personal-team" colspan="2"></td>
            `;
            
            // –î–æ–±–∞–≤–ª—è–µ–º —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤
            participants.forEach((participant, index) => {
                const row = table.insertRow();
                const isFirstInTeam = index === 0 || participants[index-1].team !== participant.team;
                
                if (isFirstInTeam) {
                    row.innerHTML = `
                        <td rowspan="2" class="team-cell divider-team-participant">${participant.team}</td>
                        <td class="name-cell divider-participant-lithoff">${participant.name}</td>
                        <td class="input-cell divider-lithoff-angle-time" id="angle_${index}">0</td>
                        <td class="input-cell divider-lithoff-time-score" id="time_lz_${index}">00:00:00</td>
                        <td class="result-cell" id="score_lz_${index}">‚Äî</td>
                        <td class="input-cell divider-quadrosim-time-score" id="time_kz_${index}">00:00:00</td>
                        <td class="result-cell" id="score_kz_${index}">‚Äî</td>
                        <td class="input-cell divider-track-laps-penalties" id="laps_${index}">0</td>
                        <td class="input-cell" id="penalty_gates_${index}">0</td>
                        <td class="input-cell" id="penalty_fall_${index}">0</td>
                        <td class="input-cell" id="penalty_flip_${index}">0</td>
                        <td class="input-cell divider-track-penalties-total" id="total_penalty_${index}">0</td>
                        <td class="result-cell divider-track-total-score" id="score_track_${index}">‚Äî</td>
                        <td class="result-cell divider-results-personal-team" id="personal_score_${index}">‚Äî</td>
                        <td rowspan="2" class="team-score-cell" id="team_score_${participant.teamIndex}">‚Äî</td>
                    `;
                } else {
                    row.innerHTML = `
                        <td class="name-cell divider-participant-lithoff">${participant.name}</td>
                        <td class="input-cell divider-lithoff-angle-time" id="angle_${index}">0</td>
                        <td class="input-cell divider-lithoff-time-score" id="time_lz_${index}">00:00:00</td>
                        <td class="result-cell" id="score_lz_${index}">‚Äî</td>
                        <td class="input-cell divider-quadrosim-time-score" id="time_kz_${index}">00:00:00</td>
                        <td class="result-cell" id="score_kz_${index}">‚Äî</td>
                        <td class="input-cell divider-track-laps-penalties" id="laps_${index}">0</td>
                        <td class="input-cell" id="penalty_gates_${index}">0</td>
                        <td class="input-cell" id="penalty_fall_${index}">0</td>
                        <td class="input-cell" id="penalty_flip_${index}">0</td>
                        <td class="input-cell divider-track-penalties-total" id="total_penalty_${index}">0</td>
                        <td class="result-cell divider-track-total-score" id="score_track_${index}">‚Äî</td>
                        <td class="result-cell divider-results-personal-team" id="personal_score_${index}">‚Äî</td>
                    `;
                }
            });
        }
        
        // ========== –†–ê–°–ß–ï–¢ –†–ï–ó–£–õ–¨–¢–ê–¢–û–í ==========
        function calculateAll() {
            const participantsData = [];
            
            // –°–æ–±–∏—Ä–∞–µ–º –¥–∞–Ω–Ω—ã–µ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤
            for (let i = 0; i < participants.length; i++) {
                const gates = parseInt(document.getElementById(`penalty_gates_${i}`).textContent) || 0;
                const falls = parseInt(document.getElementById(`penalty_fall_${i}`).textContent) || 0;
                const flips = parseInt(document.getElementById(`penalty_flip_${i}`).textContent) || 0;
                const totalPenalty = (gates * 5) + (falls * 10) + (flips * 20);
                
                document.getElementById(`total_penalty_${i}`).textContent = totalPenalty;
                
                participantsData.push({
                    index: i,
                    angle: parseFloat(document.getElementById(`angle_${i}`).textContent) || 0,
                    timeLz: timeToSeconds(document.getElementById(`time_lz_${i}`).textContent),
                    timeKz: timeToSeconds(document.getElementById(`time_kz_${i}`).textContent),
                    laps: parseFloat(document.getElementById(`laps_${i}`).textContent) || 0,
                    totalPenalty: totalPenalty,
                    teamIndex: participants[i].teamIndex
                });
            }
            
            // –ù–∞—Ö–æ–¥–∏–º –º–∞–∫—Å–∏–º—É–º—ã –∏ –º–∏–Ω–∏–º—É–º—ã
            const maxAngle = Math.max(...participantsData.map(p => p.angle));
            const minTimeLz = Math.min(...participantsData.filter(p => p.timeLz > 0).map(p => p.timeLz));
            const minTimeKz = Math.min(...participantsData.filter(p => p.timeKz > 0).map(p => p.timeKz));
            const maxLaps = Math.max(...participantsData.map(p => p.laps));
            const minPenalty = Math.min(...participantsData.filter(p => p.totalPenalty > 0).map(p => p.totalPenalty));
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –º–∞–∫—Å–∏–º—É–º–æ–≤/–º–∏–Ω–∏–º—É–º–æ–≤
            document.getElementById('maxAngle').textContent = maxAngle > 0 ? maxAngle.toFixed(1) : '0';
            document.getElementById('minTimeLz').textContent = minTimeLz > 0 ? secondsToTime(minTimeLz) : '00:00:00';
            document.getElementById('minTimeKz').textContent = minTimeKz > 0 ? secondsToTime(minTimeKz) : '00:00:00';
            document.getElementById('maxLaps').textContent = maxLaps > 0 ? maxLaps : '0';
            document.getElementById('minPenalty').textContent = minPenalty > 0 ? minPenalty : '0';
            
            // –†–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ–º –±–∞–ª–ª—ã –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —É—á–∞—Å—Ç–Ω–∏–∫–∞
            let maxScoreLz = 0, maxScoreKz = 0, maxScoreTrack = 0;
            const teamScores = [0, 0, 0, 0, 0];
            
            participantsData.forEach(data => {
                const i = data.index;
                
                // –ë–∞–ª–ª—ã –õ–∏—Ç–æ—Ñ—Ñ
                let scoreLz = 0;
                if (maxAngle > 0 && data.angle > 0 && minTimeLz > 0 && data.timeLz > 0) {
                    scoreLz = ((data.angle / maxAngle) * 70) + ((minTimeLz / data.timeLz) * 30);
                    maxScoreLz = Math.max(maxScoreLz, scoreLz);
                }
                document.getElementById(`score_lz_${i}`).textContent = scoreLz > 0 ? scoreLz.toFixed(2) : '‚Äî';
                
                // –ë–∞–ª–ª—ã –ö–≤–∞–¥—Ä–æ—Å–∏–º
                let scoreKz = 0;
                if (minTimeKz > 0 && data.timeKz > 0) {
                    scoreKz = (minTimeKz * 100) / data.timeKz;
                    maxScoreKz = Math.max(maxScoreKz, scoreKz);
                }
                document.getElementById(`score_kz_${i}`).textContent = scoreKz > 0 ? scoreKz.toFixed(2) : '‚Äî';
                
                // –ë–∞–ª–ª—ã –¢—Ä–∞—Å—Å—ã
                let scoreTrack = 0;
                if (maxLaps > 0 && data.laps > 0) {
                    const baseScore = (data.laps / maxLaps) * 100;
                    scoreTrack = baseScore - data.totalPenalty;
                    if (scoreTrack < 0) scoreTrack = 0;
                    maxScoreTrack = Math.max(maxScoreTrack, scoreTrack);
                }
                document.getElementById(`score_track_${i}`).textContent = scoreTrack > 0 ? scoreTrack.toFixed(2) : '‚Äî';
                
                // –ò—Ç–æ–≥–æ–≤—ã–π –±–∞–ª–ª
                const totalScore = scoreLz + scoreKz + scoreTrack;
                document.getElementById(`personal_score_${i}`).textContent = totalScore > 0 ? totalScore.toFixed(2) : '‚Äî';
                
                // –î–æ–±–∞–≤–ª—è–µ–º –∫ –∫–æ–º–∞–Ω–¥–Ω–æ–º—É –±–∞–ª–ª—É
                if (totalScore > 0) {
                    teamScores[data.teamIndex] += totalScore;
                }
            });
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã—Ö –±–∞–ª–ª–æ–≤
            document.getElementById('maxScoreLz').textContent = maxScoreLz.toFixed(2);
            document.getElementById('maxScoreKz').textContent = maxScoreKz.toFixed(2);
            document.getElementById('maxScoreTrack').textContent = maxScoreTrack.toFixed(2);
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –∫–æ–º–∞–Ω–¥–Ω—ã–µ –±–∞–ª–ª—ã
            teamScores.forEach((score, index) => {
                document.getElementById(`team_score_${index}`).textContent = score > 0 ? score.toFixed(2) : '‚Äî';
            });
        }
        
        // ========== –ó–ê–ì–†–£–ó–ö–ê –î–ê–ù–ù–´–• ==========
        async function loadTournamentData(manual = false) {
            if (manual) {
                showLoading(true);
                document.getElementById('refreshBtn').classList.add('loading');
            }
            
            try {
                const response = await fetch(DATA_URL + '?t=' + Date.now());
                
                if (!response.ok) {
                    throw new Error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö');
                }
                
                const data = await response.json();
                
                // –û–±–Ω–æ–≤–ª—è–µ–º –¥–∞–Ω–Ω—ã–µ –≤ —Ç–∞–±–ª–∏—Ü–µ
                for (let i = 0; i < participants.length; i++) {
                    const pData = data[`participant_${i}`];
                    if (pData) {
                        document.getElementById(`angle_${i}`).textContent = pData.angle || '0';
                        document.getElementById(`time_lz_${i}`).textContent = pData.timeLz || '00:00:00';
                        document.getElementById(`time_kz_${i}`).textContent = pData.timeKz || '00:00:00';
                        document.getElementById(`laps_${i}`).textContent = pData.laps || '0';
                        document.getElementById(`penalty_gates_${i}`).textContent = pData.penalty_gates || '0';
                        document.getElementById(`penalty_fall_${i}`).textContent = pData.penalty_fall || '0';
                        document.getElementById(`penalty_flip_${i}`).textContent = pData.penalty_flip || '0';
                    }
                }
                
                // –ü–µ—Ä–µ—Å—á–∏—Ç—ã–≤–∞–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
                calculateAll();
                
                // –û–±–Ω–æ–≤–ª—è–µ–º –≤—Ä–µ–º—è
                const now = new Date();
                document.getElementById('updateTime').textContent = now.toLocaleTimeString('ru-RU');
                document.getElementById('dataInfo').textContent = `‚úÖ –î–∞–Ω–Ω—ã–µ –∑–∞–≥—Ä—É–∂–µ–Ω—ã: ${now.toLocaleString('ru-RU')}`;
                
                if (manual) {
                    showNotification('–î–∞–Ω–Ω—ã–µ —É—Å–ø–µ—à–Ω–æ –æ–±–Ω–æ–≤–ª–µ–Ω—ã', 'success');
                }
                
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏:', error);
                document.getElementById('dataInfo').textContent = '‚è≥ –û–∂–∏–¥–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö —Ç—É—Ä–Ω–∏—Ä–∞...';
                
                if (manual) {
                    showNotification('–û—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –¥–∞–Ω–Ω—ã—Ö', 'error');
                }
            } finally {
                if (manual) {
                    showLoading(false);
                    setTimeout(() => {
                        document.getElementById('refreshBtn').classList.remove('loading');
                    }, 500);
                }
            }
        }
        
        // ========== –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø ==========
        document.addEventListener('DOMContentLoaded', function() {
            // –°–æ–∑–¥–∞–µ–º —Ç–∞–±–ª–∏—Ü—É
            createTable();
            
            // –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º –∫–Ω–æ–ø–∫—É –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
            document.getElementById('refreshBtn').addEventListener('click', () => {
                loadTournamentData(true);
            });
            
            // –ù–∞—á–∞–ª—å–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö
            showLoading(true);
            setTimeout(() => {
                loadTournamentData().then(() => {
                    showLoading(false);
                    
                    // –ó–∞–ø—É—Å–∫–∞–µ–º –∞–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ
                    setInterval(() => {
                        loadTournamentData();
                    }, UPDATE_INTERVAL);
                });
            }, 500);
            
            // –ó–∞—â–∏—Ç–∞ –æ—Ç —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
            document.addEventListener('contextmenu', (e) => {
                e.preventDefault();
            });
        });
    </script>
</body>
</html>
